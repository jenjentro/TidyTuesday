---
title: 'Tidy Tuesday: Animal Crossing'
author: "Jen T. (@jenjentro)"
date: "7/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Attach packages ----

library(tidyverse)
library(janitor)
library(here)
library(cowplot) # for attaching images to pics
library(magick)
library(forcats)

theme_set(theme_cowplot())
```

```{r Reading in ACNH Data}

# Get the Data

critic <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/critic.tsv')
user_reviews <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/user_reviews.tsv')
items <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/items.csv')
villagers <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/villagers.csv')

# I'll probably just focus on the villagers data though
```

Hello! Let's create a graph of villager personality types.

```{r Wrangling with villager types}

villager_count <- villagers %>%
  group_by(personality) %>% # Group by personality
  count() %>% # Count by personality
  arrange(-n) # Arrange from most villagers to least

# Change personality column to factor
villager_fct <- villager_count %>%
  mutate(personality = as_factor(personality))

# Change factor levels to based on frequncy
villager_by_freq <- villager_fct %>%
  mutate(personality = fct_infreq(personality))

#Check level
levels(villager_by_freq$personality)  
```


```{r}

# Villager graph
acnh_graph <- ggplot(data = villager_by_freq, aes(x = personality, y = n)) + # X variable will be personality
  geom_bar(aes(fill = personality), # Change fill color of bars by personality type
                 stat = "identity", # Use count as y variable
                 show.legend = FALSE) + # Don't show legend
  labs(x = "Villager Personality", # Change axis titles
       y = "Number of Villagers",
       title = "ACNH Villager Personalities") + # Give graph title
  scale_fill_brewer(palette = "Dark2") + # Change fill colors of histogram bars
  # geom_text(label = ..count..) + # Add data labels
  coord_flip() + # Flip x and y axes
  theme_classic() + # Change appearance of graph
  theme(
    plot.title = element_text(hjust = 0.5) # Move graph title to center
  )

acnh_graph

# Add villager thumbnails to graph
ggdraw() +
  draw_image("https://villagerdb.com/images/villagers/thumb/ankha.8bffa26.png") +
  draw_plot(acnh_graph)

```

